<script lang="ts" setup>
const code = `<script lang=\"ts\" setup>\r\nimport { onMounted, nextTick, PropType, computed, ref, watch } from 'vue';\r\n\r\nimport \"codemirror\/lib\/codemirror.css\";\r\nimport \"codemirror\/addon\/lint\/lint.css\";\r\nimport \"codemirror\/addon\/fold\/foldgutter.css\";\r\nimport \"codemirror\/addon\/hint\/show-hint.css\";\r\n\r\nimport CodeMirror from \"codemirror\";\r\n\r\nimport \"codemirror\/mode\/javascript\/javascript\";\r\nimport \"codemirror\/mode\/sql\/sql\";\r\n\r\nimport JSHINT from \"jshint\";\r\n(window as any).JSHINT = JSHINT.JSHINT;\r\n\r\nimport jsonlint from \"jsonlint-mod\";\r\n(window as any).jsonlint = jsonlint;\r\n\r\nimport \"codemirror\/addon\/lint\/javascript-lint\";\r\nimport \"codemirror\/addon\/lint\/json-lint\";\r\n\r\nimport \"codemirror\/addon\/fold\/foldcode\";\r\nimport \"codemirror\/addon\/fold\/foldgutter\";\r\nimport \"codemirror\/addon\/fold\/brace-fold\";\r\nimport \"codemirror\/addon\/hint\/show-hint\";\r\nimport \"codemirror\/addon\/hint\/javascript-hint\";\r\nimport \"codemirror\/addon\/hint\/anyword-hint\";\r\nimport \"codemirror\/addon\/edit\/closebrackets\";\r\nimport \"codemirror\/addon\/edit\/matchbrackets\";\r\nimport \"codemirror\/addon\/lint\/lint\";\r\n\r\nimport { templateRef } from \"@vueuse\/core\";\r\nimport {debounce as _debounce} from 'lodash-es'\r\ntype EditorLanguage = \"javascript\" | \"xml\" | \"json\" | \"sql\" | \"text\";\r\n\r\n\r\n\/\/ TODO - add custom Linting and Highlighting for Engine Variable Syntax (aka: {{$,middleware_id.variable}})\r\n\/\/ TODO - add a way to  fix the issue of when creating a CodeEditor while a v-expand is opening\r\n\r\nconst props = defineProps({\r\n  language: {\r\n    type: String as PropType<EditorLanguage>,\r\n    default: \"text\",\r\n  },\r\n  code:{\r\n    type: String,\r\n    default: ''\r\n  }\r\n});\r\n\r\nconst editorLang = computed(() => {\r\n  const lang = props.language;\r\n  switch (lang) {\r\n    case \"json\": {\r\n      return \"application\/json\";\r\n    }\r\n    case \"text\": {\r\n      return undefined;\r\n    }\r\n    case \"sql\":{\r\n      return 'text\/x-sql'\r\n    }\r\n    default: {\r\n      return lang;\r\n    }\r\n  }\r\n});\r\n\r\n\r\nonMounted(async () => {\r\n  await nextTick();\r\n  \/\/ setTimeout(() => {\r\n  mountEditor();\r\n  \/\/ }, 300);\r\n});\r\n\r\n\r\n\r\nconst editorEl = templateRef<HTMLTextAreaElement>(\"code-editor\");\r\nconst EditorInstance = ref<CodeMirror.Editor | null>(null);\r\nfunction mountEditor() {\r\n  EditorInstance.value = CodeMirror.fromTextArea(editorEl.value, {\r\n    lineNumbers: true,\r\n    mode: editorLang.value,\r\n    gutters: [\"CodeMirror-lint-markers\", \"CodeMirror-foldgutter\"],\r\n    lint: {\r\n      options: {\r\n        asi: true,\r\n        esversion: 8,\r\n      },\r\n    },\r\n    foldGutter: true,\r\n    autoCloseBrackets: true,\r\n    theme: \"fiqon-custom\",\r\n    fixedGutter: true,\r\n    matchBrackets: true,\r\n    lineWrapping: true,\r\n    readOnly: true,\r\n  });\r\n}\r\n\r\n<\/script>\r\n\r\n<template>\r\n  <div class=\"custom-cm-editor-container\">\r\n    <textarea ref=\"code-editor\">{{ code }}<\/textarea>\r\n  <\/div>\r\n<\/template>\r\n\r\n<style lang=\"scss\">\r\n.custom-cm-editor-container {\r\n  outline: 3px solid red;\r\n}\r\n<\/style>\r\n`;
</script>

<template>
  <div>
    <code-viewer language="vue" :code="code" />
  </div>
</template>

<style lang="scss" scoped></style>
